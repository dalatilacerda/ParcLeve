<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiluiÃ­</title>
    <style>
        /* Estilos CSS (Sem AlteraÃ§Ã£o) */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #eef2f7;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            background-color: #fff;
            padding: 30px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            box-sizing: border-box;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        h1 {
            color: #0056b3;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
            font-size: 1em;
        }

        .input-group input[type="number"],
        .input-group input[type="text"] {
            width: calc(100% - 20px);
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .input-group input[type="number"]:focus,
        .input-group input[type="text"]:focus {
            border-color: #007bff;
            outline: none;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.2);
        }

        button {
            background-color: #007bff;
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
            margin-top: 20px;
            box-sizing: border-box;
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        #result {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #eee;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        #result h2 {
            color: #0056b3;
            margin-top: 0;
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        #result p, #result ul {
            font-size: 1.05em;
            color: #444;
            margin-bottom: 10px;
        }

        #result ul {
            list-style: none;
            padding: 0;
        }

        #result ul li {
            background-color: #e9f5ff;
            margin-bottom: 8px;
            padding: 12px 15px;
            border-left: 5px solid #007bff;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        #result ul li strong {
            color: #0056b3;
            margin-bottom: 4px;
        }
        
        #result ul li span {
            font-size: 0.9em;
        }

        .error-message {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 10px 15px;
            border-radius: 5px;
            border: 1px solid #ef9a9a;
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
        }

        @media (min-width: 768px) {
            .container {
                grid-template-columns: 1fr 1fr; /* Divide em duas colunas para telas maiores */
            }
            .input-section {
                grid-column: 1 / 2; /* Inputs na primeira coluna */
            }
            .result-section {
                grid-column: 2 / 3; /* Resultados na segunda coluna */
            }
            h1 {
                grid-column: 1 / -1; /* TÃ­tulo abrange todas as colunas */
            }
            button {
                grid-column: 1 / -1; /* BotÃ£o abrange todas as colunas */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>DiluiÃ­</h1>
        <h5>Criado para descomplicar a nossa vida e a do candidato, tornando o cÃ¡lculo da diluiÃ§Ã£o de valores mais rÃ¡pido e seguro.<br><br>
Obs: O uso desta ferramenta nÃ£o substitui o conhecimento do cÃ¡lculo manual. Esteja sempre preparado para realizar a conta caso haja instabilidade.<br><br>
Por Dalati Lacerda (Operador)</h5>
        
        <div class="input-section">
            <div class="input-group">
                <label for="valsdes">Informe o valor cheio (sem desconto):</label>
                <input type="number" id="valsdes" placeholder="EX: R$1389,98" step="0.01" required>
            </div>
            <div class="input-group">
                <label for="valdparl">Informe o valor da parcela leve:</label>
                <input type="number" id="valdparl" placeholder="EX: R$79,00" step="0.01" required>
            </div>
            <div class="input-group">
                <label for="quantparc">Informe a quantidade de parcela leve (1 a 3):</label>
                <input type="number" id="quantparc" placeholder="EX: 2" min="1" max="3" required>
            </div>
            <div class="input-group">
                <label for="durdanos">Informe a duraÃ§Ã£o do curso (em anos):</label>
                <input type="number" id="durdanos" placeholder="EX: 4" min="0.5" step="0.5" required>
            </div>
            <div class="input-group">
                <label for="valdpcd">Informe o valor (com desconto padrÃ£o):</label>
                <input type="number" id="valdpcd" placeholder="EX: R$453,79" step="0.01" required>
            </div>
            <div class="input-group">
                <label for="valdpdif">Informe o segundo valor com desconto padrÃ£o (se houver):</label>
                <input type="number" id="valdpdif" placeholder="EX: R$454,00" step="0.01">
            </div>
            <div class="input-group">
                <label for="mesmudanca">Informe o mÃªs que a parcela sofre alteraÃ§Ã£o (se houver):</label>
                <input type="number" id="mesmudanca" placeholder="EX: 7Â°" min="2">
            </div>
            
            <button onclick="calcularValores()">Calcular</button>
        </div>

        <div class="result-section">
            <div id="result">
                <h2>Resultados</h2>
                <p>Preencha os campos e clique em "Calcular" para ver os resultados aqui.</p>
            </div>
        </div>
    </div>

    <script>
        // JavaScript para a lÃ³gica de cÃ¡lculo (Atualizado com o mÃªs de mudanÃ§a)
        function calcularValores() {
            // --- Coleta de Dados ---
            const valsdes = parseFloat(document.getElementById('valsdes').value);
            const valdparl = parseFloat(document.getElementById('valdparl').value);
            const quantparc = parseInt(document.getElementById('quantparc').value);
            const durdanos = parseFloat(document.getElementById('durdanos').value);
            const valdpcd = parseFloat(document.getElementById('valdpcd').value);
            
            const valdpdifInput = document.getElementById('valdpdif').value;
            const valdpdif = valdpdifInput ? parseFloat(valdpdifInput) : null;
            
            const mesMudancaInput = document.getElementById('mesmudanca').value;
            const mesMudanca = mesMudancaInput ? parseInt(mesMudancaInput) : null;

            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = ''; // Limpa resultados anteriores

            // --- ValidaÃ§Ã£o BÃ¡sica ---
            if (isNaN(valsdes) || isNaN(valdparl) || isNaN(quantparc) || isNaN(durdanos) || isNaN(valdpcd)) {
                resultDiv.innerHTML = '<p class="error-message">ðŸš¨ Por favor, preencha todos os campos obrigatÃ³rios com valores numÃ©ricos vÃ¡lidos.</p>';
                return;
            }
            if (quantparc < 1 || quantparc > 3) {
                resultDiv.innerHTML = '<p class="error-message">ðŸš¨ A quantidade de parcelas leves deve ser 1, 2 ou 3.</p>';
                return;
            }
            if (durdanos <= 0) {
                 resultDiv.innerHTML = '<p class="error-message">ðŸš¨ A duraÃ§Ã£o do curso deve ser maior que zero.</p>';
                return;
            }
            if ((valdpdif !== null && mesMudanca === null) || (valdpdif === null && mesMudanca !== null)) {
                resultDiv.innerHTML = '<p class="error-message">ðŸš¨ AtenÃ§Ã£o: Para a alteraÃ§Ã£o de valor, vocÃª deve preencher o **Valor da MudanÃ§a** E o **MÃªs de InÃ­cio da MudanÃ§a**.</p>';
                return;
            }
            if (mesMudanca !== null && mesMudanca <= quantparc) {
                resultDiv.innerHTML = `<p class="error-message">ðŸš¨ Erro: O mÃªs de mudanÃ§a (${mesMudanca}Â°) nÃ£o pode ser igual ou menor que o nÃºmero de parcelas leves (${quantparc} parcelas).</p>`;
                return;
            }

            // --- CÃ¡lculos ---
            const durMesesTotal = durdanos * 12;
            const mesesCompensacao = durMesesTotal - quantparc;

            if (mesesCompensacao <= 0) {
                resultDiv.innerHTML = '<p class="error-message">ðŸš¨ Erro: A quantidade de parcelas leves Ã© igual ou superior Ã  duraÃ§Ã£o total do curso.</p>';
                return;
            }

            const diferencaUnitParcLeve = valsdes - valdparl;
            const valorTotalRedistribuir = diferencaUnitParcLeve * quantparc;
            const compensacaoMensal = valorTotalRedistribuir / mesesCompensacao;

            const valorParcelaNormal = valdpcd + compensacaoMensal;
            let valorParcelaMudanca = null;
            if (valdpdif !== null) {
                valorParcelaMudanca = valdpdif + compensacaoMensal;
            }

            // --- ExibiÃ§Ã£o dos Resultados ---
            
            let htmlContent = '<h2>Resultados do CÃ¡lculo</h2>';
            htmlContent += `<p><strong>DuraÃ§Ã£o Total do Curso:</strong> ${parseInt(durMesesTotal)} meses</p>`;
            htmlContent += `<p><strong>Valor diluÃ­do em parcelas:</strong> R$ ${compensacaoMensal.toFixed(2).replace('.', ',')}</p>`;

            htmlContent += '<h3>Parcelas detalhadas:</h3>';
            htmlContent += '<ul>';

            // 1. Parcela Leve
            const pluralLeve = quantparc > 1 ? 'Parcelas Leves' : 'Parcela Leve';
            const mesesLeve = quantparc > 1 ? `1Â° ao ${quantparc}Â° mÃªs` : `1Â° mÃªs`;

            htmlContent += `<li><strong>${mesesLeve}</strong>: ${pluralLeve}`;
            htmlContent += `<span>Valor: R$ ${valdparl.toFixed(2).replace('.', ',')}</span></li>`;

            // 2. Parcela Normal e MudanÃ§a
            const inicioNormal = quantparc + 1;

            if (valdpdif === null) {
                // CASO 1: SEM MUDANÃ‡A (valdpdif = null)
                
                const fimTotal = parseInt(durMesesTotal);
                let descricaoPeriodo = `${inicioNormal}Â° mÃªs atÃ© o ${fimTotal}Â° mÃªs aproximadamente`;
                let valorFormatado = valorParcelaNormal.toFixed(2).replace('.', ',');

                htmlContent += `<li><strong>${descricaoPeriodo}</strong>: Parcela com desconto + Parcela Leve diluÃ­da`;
                htmlContent += `<span>Valor: R$ ${valorFormatado} + Reajuste anual</span></li>`;

            } else {
                // CASO 2: COM MUDANÃ‡A (valdpdif !== null)
                
                const mesFimPrimeiroPeriodo = mesMudanca - 1;
                
                // --- 2.1. Primeiro PerÃ­odo (Parcela Base + CompensaÃ§Ã£o, ANTES da mudanÃ§a) ---
                if (inicioNormal < mesMudanca) {
                    
                    let descricaoPeriodo1 = `${inicioNormal}Â° mÃªs atÃ© o ${mesFimPrimeiroPeriodo}Â° mÃªs aproximadamente`;
                    let valorFormatado1 = valorParcelaNormal.toFixed(2).replace('.', ',');
                    
                    htmlContent += `<li><strong>${descricaoPeriodo1}</strong>: Parcela Base + CompensaÃ§Ã£o`;
                    htmlContent += `<span>Valor: R$ ${valorFormatado1}</span></li>`;
                }

                // --- 2.2. Segundo PerÃ­odo (Parcela MUDANÃ‡A + CompensaÃ§Ã£o, DO mÃªs de mudanÃ§a em diante) ---
                
                let inicioSegundoPeriodo = mesMudanca;
                let fimSegundoPeriodo = parseInt(durMesesTotal);
                let valorFormatado2 = valorParcelaMudanca.toFixed(2).replace('.', ',');
                
                let descricaoPeriodo2 = `${inicioSegundoPeriodo}Â° mÃªs atÃ© o ${fimSegundoPeriodo}Â° mÃªs aproximadamente`;

                htmlContent += `<li><strong>${descricaoPeriodo2}</strong>: Parcela com Desconto + valor de parcela leve`;
                htmlContent += `<span>Valor: R$ ${valorFormatado2} + Reajuste anual</span></li>`;
            }
            
            htmlContent += '</ul>';

            resultDiv.innerHTML = htmlContent;
        }
    </script>
</body>
</html>
